<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>D3绘制折线</title>
    <script src="d3/d3.min.js"></script>
    <script>
        //绘制折线图
        function poly_line(xdata, ydata, width, height) {
        let SVG_SIZE = { width: width, height: height }
        let SVG_MARGIN = { left: 60, top: 60, right: 60, bottom: 60 }
        let svg_g = d3.select('#container-line').append('svg').attr('width', SVG_SIZE.width).attr('height', SVG_SIZE.height).append('g');;

        let xScale = d3.scaleBand()
        .domain(xdata)
        .rangeRound([SVG_MARGIN.left, SVG_SIZE.width - SVG_MARGIN.right]);
        let xAxis = d3.axisBottom(xScale);
        let yScale = d3.scaleLinear()
        .domain([d3.min(ydata, function (d){return parseFloat(d);}), d3.max(ydata, function (d){return parseFloat(d);})])
        .rangeRound([SVG_SIZE.height - SVG_MARGIN.top, SVG_MARGIN.bottom]);
        let yAxis = d3.axisLeft(yScale);

        svg_g
            .append('g')
            .attr('transform', 'translate(0,' + (SVG_SIZE.height - SVG_MARGIN.bottom) + ')')
            .call(xAxis);
        svg_g.append('g')
            .attr('transform', 'translate(' + SVG_MARGIN.left + ',0)')
            .call(yAxis);
        svg_g.append('text')
            .text('手数/天')

        let line_generator = d3.line()
        .x(function (d,i) {
            console.log('x->' + xdata[i]);
            var a = xdata[i].substr(0, 4);
            var b = xdata[i].substr(4, 4);
            return xScale(xdata[i]);
        })
        .y(function (d,i) {
            console.log('y->'+d);
            return yScale(d);
        })
        //折线变得圆滑，如果不需要可以去掉
        .curve(d3.curveMonotoneX);

        svg_g.append('path')
        .attr('d', line_generator(ydata))
        .attr('fill', 'none')
        .attr('stroke', 'blueviolet')
        .attr('stroke-width', '2')
        .attr("stroke-linejoin", "round")
        .attr("stroke-linecap", "round")
        .attr('cursor', 'pointer')
        .on('touchmove', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('touchstart', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('touchend', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', 'blueviolet');
        })
        .on('mousemove', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('mouseover', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('mouseout', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', 'blueviolet');
        })
        .on('click', function () {
        alert('曲线事件已触发！');
        });

        /*g.append('path')
        .attr('d', line_generator(ydata))
        .attr('fill', 'none')
        .attr('stroke', 'blueviolet')
        .attr("stroke-linejoin", "round")
        .attr("stroke-linecap", "round")
        .attr('stroke-width', '2')
        .attr('cursor', 'pointer')
        .on('touchmove', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('touchstart', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('touchend', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', 'blueviolet');
        })
        .on('mousemove', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('mouseover', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', '#CB7730');
        })
        .on('mouseout', function (d, i) {
        d3.select(this).transition().duration(100).attr('stroke', 'blueviolet');
        })
        .on('click', function () {
        alert('曲线事件已触发！');
        });*/
        }

        window.onload = function () {
        let xdata = AAAAAA;
        let ydata = BBBBBB;
        //xdata = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
        //ydata = [20, 35, 18, 16, 13, 12, 9, 11, 19, 27, 30, 26];
        poly_line(xdata,ydata, 1000, 800);
        }
    </script>
</head>

<body>
    <div id="container-line" width="1000" height="800"></div>
</body>
